#include <Windows.h>
//#include <iostream>

/*
* REMEMBER TO RUN AS ADMINISTRATOR!
*/


int main(int argc, char** argv) {
    HWND wesnoth_window = FindWindow(NULL, L"Bitwa o Wesnoth - 1.14.9"); // (Get-Process -id 7664 -ErrorAction SilentlyContinue).MainWindowTitle
    DWORD process_id = 9812;
    DWORD gold_value = 0;
    DWORD64 bytes_read = 0;
    DWORD new_gold_value = 555;
    DWORD64 bytes_written = 0;

    GetWindowThreadProcessId(wesnoth_window, &process_id);

    HANDLE wesnoth_process = OpenProcess(PROCESS_ALL_ACCESS, true, process_id);

    //READING MEMORY
    ReadProcessMemory(wesnoth_process, (void*)0x017EED18, &gold_value, 4, &bytes_read);
    gold_value += 0xA90;
    ReadProcessMemory(wesnoth_process, (void*)gold_value, &gold_value, 4, &bytes_read);
    gold_value += 4;
    ReadProcessMemory(wesnoth_process, (void*)gold_value, &gold_value, 4, &bytes_read);

    //WRITING TO MEMORY
    WriteProcessMemory(wesnoth_process, (void*)gold_value, &new_gold_value, 4, &bytes_written);

    //DEBUG
    //std::cout << "Wesnoth id: " << process_id << " " << gold_value << " -> " << new_gold_value << std::endl

    return 0;
}